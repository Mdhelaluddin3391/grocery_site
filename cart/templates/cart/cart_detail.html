{% extends 'store/base.html' %}
{% load static %}

{% block title %}Your Shopping Cart{% endblock title %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'cart/css/cart_detail.css' %}">
{% endblock extra_css %}

{% block content %}
<div class="cart-page-container">
    <div id="cart-content-wrapper" {% if not cart.items.all %}style="display: none;"{% endif %}>
        <h1 id="cart-title">ðŸ›’ Your Cart ({{ cart.get_total_items }} item{{ cart.get_total_items|pluralize }})</h1>
        <div class="cart-layout">
            <div class="cart-items-list">
                {% for item in cart.items.all %}
                <div class="cart-item-card" id="cart-item-{{ item.id }}">
                    <div class="item-image"><img src="{{ item.product.image|default:'https://via.placeholder.com/80' }}" alt="{{ item.product.name }}"></div>
                    <div class="item-details">
                        <p class="item-name">{{ item.product.name }}</p>
                        <p class="item-price">â‚¹{{ item.product.price }}</p>
                    </div>
                    <div class="item-actions">
                        <div class="quantity-selector">
                            <button class="quantity-btn" data-action="decrement" data-item-id="{{ item.id }}">-</button>
                            <span class="quantity-value" id="quantity-{{ item.id }}">{{ item.quantity }}</span>
                            <button class="quantity-btn" data-action="increment" data-item-id="{{ item.id }}">+</button>
                        </div>
                    </div>
                    <div class="item-subtotal">â‚¹<span id="subtotal-{{ item.id }}">{{ item.get_subtotal|floatformat:2 }}</span></div>
                    <a href="{% url 'remove_from_cart' item.id %}" class="remove-btn">Remove</a>
                </div>
                {% endfor %}
            </div>
            <div class="order-summary-card">
                <h3>Price Details</h3>
                <div class="summary-row">
                    <span>Price (<span id="summary-item-count">{{ cart.get_total_items }}</span> items)</span>
                    <span>â‚¹<span id="summary-subtotal">{{ cart.get_subtotal|floatformat:2 }}</span></span>
                </div>
                <div class="summary-row">
                    <span>Discount</span>
                    <span>- â‚¹<span id="summary-discount">{{ cart.discount_amount|floatformat:2 }}</span></span>
                </div>
                <div class="summary-row">
                    <span>Delivery Charges</span>
                    <span>+ â‚¹<span id="summary-delivery">{{ cart.delivery_charge|floatformat:2 }}</span></span>
                </div>
                <hr>
                <div class="summary-row total">
                    <span>Total Amount</span>
                    <span>â‚¹<span id="summary-grand-total">{{ cart.get_grand_total|floatformat:2 }}</span></span>
                </div>
                <button class="checkout-btn">Proceed to Checkout</button>
            </div>
        </div>
    </div>
    <div id="empty-cart-container" {% if cart.items.all %}style="display: none;"{% endif %}>
        <div class="empty-cart">
            <img src="https://cdn-icons-png.flaticon.com/512/2762/2762885.png" alt="Empty Cart">
            <p>Your shopping cart looks a little empty.</p>
            <a href="{% url 'home' %}" class="btn">Continue Shopping</a>
        </div>
    </div>
</div>

<script src="{% static 'cart/js/cart_detail.js' %}"></script>
{% endblock content %}