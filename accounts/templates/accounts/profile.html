{% extends 'store/base.html' %}
{% load static %}

{% block title %}My Profile{% endblock title %}

{% block extra_css %}
<style>
    .profile-container { max-width: 900px; margin: 30px auto; padding: 20px; }
    .profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
    .profile-header img { width: 80px; height: 80px; border-radius: 50%; background-color: #f0f0f0; padding: 10px; }
    .profile-header h1 { margin: 0; font-size: 2rem; color: #333; }
    .profile-section { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); margin-bottom: 20px; }
    .profile-section h3 { font-size: 1.4rem; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #00a94f; }
    .profile-details p { margin: 5px 0; font-size: 1rem; color: #555; }
    .profile-details strong { color: #000; display: inline-block; width: 150px; }
    .address-card { border: 1px solid #ddd; padding: 15px; border-radius: 6px; margin-bottom: 10px; position: relative; }
    .address-card strong { display: block; margin-bottom: 5px; color: #333; }
    .action-link { display: inline-block; margin-top: 15px; padding: 10px 15px; border-radius: 5px; text-decoration: none; font-weight: 500; font-size: 0.9rem; }
    .btn-edit { background-color: #007bff; color: #fff; }
    .btn-delete { background-color: #e74c3c; color: #fff; margin-left: 10px;}
    .action-list a { color: #00a94f; text-decoration: none; margin-right: 20px; font-weight: 500; }
</style>
{% endblock extra_css %}

{% block content %}
<div class="profile-container">

    {% if messages %}
        {% for message in messages %}
        <div style="background-color: {% if message.tags == 'success' %}#d4edda{% else %}#f8d7da{% endif %}; color: {% if message.tags == 'success' %}#155724{% else %}#721c24{% endif %}; border: 1px solid {% if message.tags == 'success' %}#c3e6cb{% else %}#f5c6cb{% endif %}; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
            {{ message }}
        </div>
        {% endfor %}
    {% endif %}

    <div class="profile-header">
        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Profile Icon">
        <h1>Hello, {{ user.phone_number }}</h1>
    </div>

    <div class="profile-section">
        <h3>Account Details</h3>
        <div class="profile-details">
            <p><strong>Mobile:</strong> {{ user.phone_number }}</p>
            <p><strong>Joined:</strong> {{ user.date_joined|date:"F d, Y" }}</p>
            <p><strong>Status:</strong> <span style="color: #28a745;">Verified Customer</span></p>
        </div>
    </div>

    <div class="profile-section">
        <h3>Your Orders</h3>
        <p>Your recent orders will appear here. (To be implemented)</p>
        <a href="#" class="action-link btn-edit">View All Orders</a>
    </div>

    <div class="profile-section">
        <h3>Shipping Addresses</h3>
        {% if addresses %}
            {% for address in addresses %}
            <div class="address-card">
                <strong>{{ address.get_address_type_display }} {% if address.is_default %}(Default){% endif %}</strong>
                <p>{{ address.address_line_1 }}, {% if address.address_line_2 %}{{ address.address_line_2 }}, {% endif %} {{ address.city }}, {{ address.state }} - {{ address.pincode }}</p>
            </div>
            {% endfor %}
        {% else %}
            <p>No saved addresses found. Add one during checkout!</p>
        {% endif %}
        <a href="{% url 'checkout' %}" class="action-link btn-edit">Add New Address</a>
    </div>

    <div class="profile-section action-list">
        <h3>Danger Zone</h3>
        <a href="{% url 'logout' %}" class="action-link btn-edit" style="background-color: #555;">Logout</a>
        <a href="{% url 'delete_account' %}" class="action-link btn-delete">Delete Account</a>
    </div>

</div>
{% endblock content %}