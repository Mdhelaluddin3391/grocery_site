{% extends 'store/base.html' %}
{% load static %}

{% block title %}My Profile{% endblock title %}

{% block extra_css %}
<style>
    /* ... (aapka CSS jaisa hai waisa hi rahega) ... */
    .order-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    .order-table th, .order-table td { border: 1px solid #eee; padding: 10px; text-align: left; font-size: 0.9rem; }
    .order-table th { background-color: #f7f7f7; font-weight: 600; }
    .status-pending { color: #f39c12; font-weight: bold; }
    .status-delivered { color: #28a745; font-weight: bold; }
    .status-cancelled { color: #e74c3c; font-weight: bold; }
</style>
{% endblock extra_css %}

{% block content %}
<div class="profile-container">
    {# ... (Messages aur Profile Header ka code waise hi rahega) ... #}

    <div class="profile-header">
        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Profile Icon">
        <h1>Hello, {{ customer.phone_number }}</h1>
    </div>

    <div class="profile-section">
        <h3>Account Details</h3>
        <div class="profile-details">
            <p><strong>Mobile:</strong> {{ customer.phone_number }}</p>
            <p><strong>Joined:</strong> {{ customer.created_at|date:"F d, Y" }}</p>
            <p><strong>Status:</strong> <span style="color: #28a745;">Verified Customer</span></p>
        </div>
    </div>

    {# --- "YOUR ORDERS" SECTION MEIN BADLAV --- #}
    <div class="profile-section">
        <h3>Your Orders</h3>
        {% if orders %}
            <table class="order-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Date</th>
                        <th>Total</th>
                        <th>Status</th>
                        <th>Payment</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                    <tr>
                        <td>{{ order.order_id }}</td>
                        <td>{{ order.created_at|date:"d M, Y" }}</td>
                        <td>â‚¹{{ order.total_amount|floatformat:2 }}</td>
                        <td>
                            <span class="status-{{ order.status|lower }}">{{ order.status }}</span>
                        </td>
                        <td>{{ order.payment_method }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>You haven't placed any orders yet. Let's start shopping!</p>
            <a href="{% url 'home' %}" class="action-link btn-edit">Shop Now</a>
        {% endif %}
    </div>
    {# --------------------------------------------- #}

    {# ... (Shipping Addresses aur Danger Zone ka code waise hi rahega) ... #}
     <div class="profile-section">
        <h3>Shipping Addresses</h3>
        {% if addresses %}
            {% for address in addresses %}
            <div class="address-card">
                <strong>{{ address.get_address_type_display }} {% if address.is_default %}(Default){% endif %}</strong>
                <p>{{ address.address_line_1 }}, {% if address.address_line_2 %}{{ address.address_line_2 }}, {% endif %} {{ address.city }}, {{ address.state }} - {{ address.pincode }}</p>
            </div>
            {% endfor %}
        {% else %}
            <p>No saved addresses found. Add one during checkout!</p>
        {% endif %}
        <a href="{% url 'checkout' %}" class="action-link btn-edit">Add New Address</a>
    </div>

    <div class="profile-section action-list">
        <h3>Danger Zone</h3>
        <a href="{% url 'logout' %}" class="action-link btn-edit" style="background-color: #555;">Logout</a>
        <a href="{% url 'delete_account' %}" class="action-link btn-delete">Delete Account</a>
    </div>
</div>
{% endblock content %}